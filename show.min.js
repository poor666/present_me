assetsURL="http://dl.dropbox.com/u/1205299/present.me/";InflectionJS={id_suffix:new RegExp("(_ids|_id)$","g"),underbar:new RegExp("_","g")};if(!String.prototype.humanize){String.prototype.humanize=function(B){var A=this.toLowerCase();A=A.replace(InflectionJS.id_suffix,"");A=A.replace(InflectionJS.underbar," ");if(!B){A=A.capitalize();}return A;};}if(!String.prototype.capitalize){String.prototype.capitalize=function(){var A=this.toLowerCase();A=A.substring(0,1).toUpperCase()+A.substring(1);return A;};}function addScript(A){var B=document.createElement("script");B.type="text/javascript";B.src=A;$("head").append(B);}function addCss(A){var B=document.createElement("link");B.type="text/css";B.href=A;B.rel="stylesheet";$("head").append(B);}addCss(assetsURL+"css/show_style.css");function loadBigViewer(A){$("#overlay").css("visibility","visible");$(".page img:not(.loader)").remove();var B=$("<img>");B.hide();B.bind("load",function(){$("#overlay").css("visibility","hidden");$(this).show();});$(".page a").append(B);B.attr("src",A);}function rotatePresentation(A){var B=result.pages[A[count].page];var C="export/"+B.name+"/"+B.states[A[count].state].state;loadBigViewer(C);$("body").css("background-image","url(export/"+B.background.image+")");$("body").css("background-repeat",B.background.repeat);ahref=$(".page a");ahref.attr("href",B.name.humanize()+"/"+B.states[A[count].state].state.humanize().slice(0,-4));ahref.attr("rel","address:"+B.name.humanize()+"/"+B.states[A[count].state].state.humanize().slice(0,-4));$(document).attr("title",B.name.humanize()+", "+B.states[A[count].state].state.humanize().slice(0,-4)+" - "+result.setup.title.humanize());$.address.value(B.name.humanize()+"/"+B.states[A[count].state].state.humanize().slice(0,-4));count++;}$(document).ajaxError(function(C,B,A){alert("falta os ficheiros");});$.address.externalChange(function(A){_url=A.value.split("/");fileInit={pasta:_url[1],file:_url[2]};if(typeof show=="object"){count=findPage(fileInit).i;rotatePresentation(show);}else{}});$.address.change(function(A){_url=A.value.split("/");fileInit={pasta:_url[1],file:_url[2]};});$(document).ready(function(){$.address.init(function(A){_url=A.value.split("/");fileInit={pasta:_url[1],file:_url[2]};startPage();});});function startPage(){r=window.location.pathname.split("/index.html");$.getJSON("export/data.json",function(D,C,B){result=D;if(result==null){}else{show=new Array();$.each(D.pages,function(F,G){$.each(D.pages[F].states,function(H,I){show.push({page:F,state:H,pageLabel:D.pages[F].name,stateLabel:D.pages[F].states[H].state});});});if(typeof (fileInit.pasta)=="string"&&typeof (fileInit.file)=="string"){count=findPage(fileInit).i;}else{count=0;}var A=result.pages[show[count].page];var E=$("<div class='page'>").appendTo("#main");E.append('<a href="#" rel="#"><img></a>');$(document).attr("title",A.name.humanize()+", "+A.states[show[count].state].state.humanize().slice(0,-4)+" - "+result.setup.title);$.address.value(A.name.humanize()+"/"+A.states[show[count].state].state.humanize().slice(0,-4));$("a").click(function(){if(show.length==count){count=0;}rotatePresentation(show);});$("a").address(function(){return $(this).attr("href").replace(/^#/,"");});rotatePresentation(show);}});}function findPage(A){var B=new Array();$.each(show,function(C,D){if(A.pasta.humanize()==D.pageLabel.humanize()){B.push(D);}});$.each(B,function(C,D){if(A.file.humanize()==D.stateLabel.humanize().slice(0,-4)){obFInal={page:D.page,state:D.state};}});$.each(show,function(C,D){if((D.page==obFInal.page)&&(D.state==obFInal.state)){obFInal.i=C;}});return obFInal;}